specVersion: 1.2.0
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: RoyaltyAdvanceFactory
    network: base-sepolia
    source:
      abi: RoyaltyAdvanceFactory
      address: "0x7F089CB03A9Ad6e89F2a42A186059Dce29FC2360"
      startBlock: 32038340
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Stats
        - Expense
        - AdvanceContract
        - AdvanceContractCollateral
      abis:
        - name: RoyaltyAdvanceFactory
          file: ./abis/RoyaltyAdvanceFactory.json
      eventHandlers:
        - event: Initialized(uint64)
          handler: handleInitialized
        - event: AdvanceContractCreated(address,address,address,(address,uint256,uint256)[],uint256,uint256,uint256,address,address)
          handler: handleAdvanceContractCreated
          receipt: true
      file: ./src/royalty-advance-factory.ts
  - kind: ethereum
    name: ERC20Token
    network: base-sepolia
    source:
      abi: ERC20
      address: "0x46Bc2338a282383fe2585Ef5F0171E62FdCEf3B0"
      startBlock: 27756618
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Stats
        - Expense
        - AdvanceContract
      abis:
        - name: ERC20
          file: ./abis/ERC20.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleERC20Transfer
          receipt: true
        - event: Approval(indexed address,indexed address,uint256)
          handler: handleERC20Approval
          receipt: true
      file: ./src/ERC20Token.ts
templates:
  - kind: ethereum
    name: RoyaltyAdvance
    network: base-sepolia
    source:
      abi: RoyaltyAdvance
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Stats
        - Expense
        - AdvanceRepaid
        - AdvanceRevoked
        - AdvanceContract
        - AdvanceProvided
        - AdvancePartiallyRepaid
      abis:
        - name: RoyaltyAdvance
          file: ./abis/RoyaltyAdvance.json
      eventHandlers:
        - event: AdvanceProvided(address)
          handler: handleAdvanceProvided
          receipt: true
        - event: AdvancePartiallyRepaid(uint256)
          handler: handleAdvancePartiallyRepaid
          receipt: true
        - event: AdvanceRepaid(uint256)
          handler: handleAdvanceRepaid
          receipt: true
        - event: AdvanceRevoked()
          handler: handleAdvanceRevoked
          receipt: true
      file: ./src/royalty-advance.ts
